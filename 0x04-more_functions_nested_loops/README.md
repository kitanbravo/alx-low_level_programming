more nested loop and functions
